'use strict';
Object.defineProperty(exports, "__esModule", { value: true });
exports.parse = void 0;
const errors_1 = require("../descriptors/errors");
const { WRONG_MODIFICATION_PATTERN, WRONG_ARGUMENTS_USED } = errors_1.ErrorsTypes;
const extract_1 = require("./extract");
const parse = (self) => {
    if (!self || !self.constructor) {
        throw new WRONG_MODIFICATION_PATTERN;
    }
    const proto = Reflect.getPrototypeOf(self);
    if (self.constructor.name.toString() !== proto.constructor.name.toString()) {
        throw new WRONG_ARGUMENTS_USED(`have to use "instance" itself: '${self.constructor.name}' vs '${proto.constructor.name}'`);
    }
    const protoProto = Reflect.getPrototypeOf(proto);
    if (protoProto && proto.constructor.name.toString() !== protoProto.constructor.name.toString()) {
        throw new WRONG_ARGUMENTS_USED(`have to use "instance" itself: '${proto.constructor.name}' vs '${protoProto.constructor.name}'`);
    }
    const { name } = proto.constructor;
    const props = (0, extract_1.extract)(Object.assign({}, self));
    delete props.constructor;
    const joint = (0, extract_1.extract)(Object.assign({}, proto));
    delete joint.constructor;
    const parent = protoProto;
    return {
        name,
        props,
        self,
        proto,
        joint,
        parent,
    };
};
exports.parse = parse;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFyc2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvdXRpbHMvcGFyc2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWSxDQUFDOzs7QUFFYixrREFBb0Q7QUFDcEQsTUFBTSxFQUNMLDBCQUEwQixFQUMxQixvQkFBb0IsRUFDcEIsR0FBRyxvQkFBVyxDQUFDO0FBUWhCLHVDQUFvQztBQUU3QixNQUFNLEtBQUssR0FBRyxDQUFFLElBQVMsRUFBUSxFQUFFO0lBRXpDLElBQUssQ0FBQyxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxFQUFHLENBQUM7UUFDbEMsTUFBTSxJQUFJLDBCQUEwQixDQUFDO0lBQ3RDLENBQUM7SUFFRCxNQUFNLEtBQUssR0FBRyxPQUFPLENBQUMsY0FBYyxDQUFFLElBQUksQ0FBWSxDQUFDO0lBRXZELElBQUssSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLEtBQUssS0FBSyxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLEVBQUcsQ0FBQztRQUM5RSxNQUFNLElBQUksb0JBQW9CLENBQUUsbUNBQW1DLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxTQUFTLEtBQUssQ0FBQyxXQUFXLENBQUMsSUFBSSxHQUFHLENBQUUsQ0FBQztJQUM5SCxDQUFDO0lBRUQsTUFBTSxVQUFVLEdBQVEsT0FBTyxDQUFDLGNBQWMsQ0FBRSxLQUFLLENBQUUsQ0FBQztJQUN4RCxJQUFLLFVBQVUsSUFBSSxLQUFLLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsS0FBSyxVQUFVLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsRUFBRyxDQUFDO1FBQ2xHLE1BQU0sSUFBSSxvQkFBb0IsQ0FBRSxtQ0FBbUMsS0FBSyxDQUFDLFdBQVcsQ0FBQyxJQUFJLFNBQVMsVUFBVSxDQUFDLFdBQVcsQ0FBQyxJQUFJLEdBQUcsQ0FBRSxDQUFDO0lBQ3BJLENBQUM7SUFLRCxNQUFNLEVBQUUsSUFBSSxFQUFFLEdBQUcsS0FBSyxDQUFDLFdBQVcsQ0FBQztJQUVuQyxNQUFNLEtBQUssR0FBUSxJQUFBLGlCQUFPLG9CQUFPLElBQUksRUFBSSxDQUFDO0lBRTFDLE9BQU8sS0FBSyxDQUFDLFdBQVcsQ0FBQztJQUV6QixNQUFNLEtBQUssR0FBUSxJQUFBLGlCQUFPLEVBQUUsTUFBTSxDQUFDLE1BQU0sQ0FBRSxFQUFFLEVBQUUsS0FBSyxDQUFFLENBQUUsQ0FBQztJQUN6RCxPQUFPLEtBQUssQ0FBQyxXQUFXLENBQUM7SUFFekIsTUFBTSxNQUFNLEdBQUcsVUFBVSxDQUFDO0lBUzFCLE9BQU87UUFFTixJQUFJO1FBRUosS0FBSztRQUdMLElBQUk7UUFDSixLQUFLO1FBRUwsS0FBSztRQUVMLE1BQU07S0FFTixDQUFDO0FBQ0gsQ0FBQyxDQUFDO0FBckRXLFFBQUEsS0FBSyxTQXFEaEIiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbmltcG9ydCB7IEVycm9yc1R5cGVzIH0gZnJvbSAnLi4vZGVzY3JpcHRvcnMvZXJyb3JzJztcbmNvbnN0IHtcblx0V1JPTkdfTU9ESUZJQ0FUSU9OX1BBVFRFUk4sXG5cdFdST05HX0FSR1VNRU5UU19VU0VEXG59ID0gRXJyb3JzVHlwZXM7XG5cbi8vIGltcG9ydCB7IGNvbnN0YW50cyB9IGZyb20gJy4uL2NvbnN0YW50cyc7XG4vLyBjb25zdCB7XG4vLyBcdE1ORU1PTklDQSxcbi8vIFx0U3ltYm9sQ29uc3RydWN0b3JOYW1lXG4vLyB9ID0gY29uc3RhbnRzO1xuXG5pbXBvcnQgeyBleHRyYWN0IH0gZnJvbSAnLi9leHRyYWN0JztcblxuZXhwb3J0IGNvbnN0IHBhcnNlID0gKCBzZWxmOiBhbnkgKTogYW55ID0+IHtcblxuXHRpZiAoICFzZWxmIHx8ICFzZWxmLmNvbnN0cnVjdG9yICkge1xuXHRcdHRocm93IG5ldyBXUk9OR19NT0RJRklDQVRJT05fUEFUVEVSTjtcblx0fVxuXG5cdGNvbnN0IHByb3RvID0gUmVmbGVjdC5nZXRQcm90b3R5cGVPZiggc2VsZiApIGFzIG9iamVjdDtcblxuXHRpZiAoIHNlbGYuY29uc3RydWN0b3IubmFtZS50b1N0cmluZygpICE9PSBwcm90by5jb25zdHJ1Y3Rvci5uYW1lLnRvU3RyaW5nKCkgKSB7XG5cdFx0dGhyb3cgbmV3IFdST05HX0FSR1VNRU5UU19VU0VEKCBgaGF2ZSB0byB1c2UgXCJpbnN0YW5jZVwiIGl0c2VsZjogJyR7c2VsZi5jb25zdHJ1Y3Rvci5uYW1lfScgdnMgJyR7cHJvdG8uY29uc3RydWN0b3IubmFtZX0nYCApO1xuXHR9XG5cblx0Y29uc3QgcHJvdG9Qcm90bzogYW55ID0gUmVmbGVjdC5nZXRQcm90b3R5cGVPZiggcHJvdG8gKTtcblx0aWYgKCBwcm90b1Byb3RvICYmIHByb3RvLmNvbnN0cnVjdG9yLm5hbWUudG9TdHJpbmcoKSAhPT0gcHJvdG9Qcm90by5jb25zdHJ1Y3Rvci5uYW1lLnRvU3RyaW5nKCkgKSB7XG5cdFx0dGhyb3cgbmV3IFdST05HX0FSR1VNRU5UU19VU0VEKCBgaGF2ZSB0byB1c2UgXCJpbnN0YW5jZVwiIGl0c2VsZjogJyR7cHJvdG8uY29uc3RydWN0b3IubmFtZX0nIHZzICcke3Byb3RvUHJvdG8uY29uc3RydWN0b3IubmFtZX0nYCApO1xuXHR9XG5cblx0Ly8gY29uc3QgYXJncyA9IHNlbGZbU3ltYm9sQ29uc3RydWN0b3JOYW1lXSA/XG5cdC8vIHNlbGZbU3ltYm9sQ29uc3RydWN0b3JOYW1lXS5hcmdzIDogW107XG5cblx0Y29uc3QgeyBuYW1lIH0gPSBwcm90by5jb25zdHJ1Y3RvcjtcblxuXHRjb25zdCBwcm9wczogYW55ID0gZXh0cmFjdCggeyAuLi5zZWxmIH0gKTtcblx0Ly8gcHJvcHMuY29uc3RydWN0b3IgPSB1bmRlZmluZWQ7XG5cdGRlbGV0ZSBwcm9wcy5jb25zdHJ1Y3RvcjtcblxuXHRjb25zdCBqb2ludDogYW55ID0gZXh0cmFjdCggT2JqZWN0LmFzc2lnbigge30sIHByb3RvICkgKTtcblx0ZGVsZXRlIGpvaW50LmNvbnN0cnVjdG9yO1xuXG5cdGNvbnN0IHBhcmVudCA9IHByb3RvUHJvdG87XG5cdC8vIFRPRE86IGRlZXAgcGFyc2Vcblx0Ly8gbGV0IHBhcmVudDtcblx0Ly8gaWYgKCBwcm90b1Byb3RvWyBTeW1ib2xDb25zdHJ1Y3Rvck5hbWUgXSA9PT0gTU5FTU9OSUNBICkge1xuXHQvLyBcdHBhcmVudCA9IHBhcnNlKCBwcm90b1Byb3RvICk7XG5cdC8vIH0gZWxzZSB7XG5cdC8vIFx0cGFyZW50ID0gUmVmbGVjdC5nZXRQcm90b3R5cGVPZiggcHJvdG9Qcm90byApO1xuXHQvLyB9XG5cblx0cmV0dXJuIHtcblxuXHRcdG5hbWUsXG5cblx0XHRwcm9wcyxcblx0XHQvLyB0aGUgbGluZSBiZWxvdyBjb3B5IHN5bWJvbHMgYWxzb1xuXG5cdFx0c2VsZixcblx0XHRwcm90byxcblxuXHRcdGpvaW50LFxuXHRcdC8vIGFyZ3MsXG5cdFx0cGFyZW50LFxuXG5cdH07XG59O1xuIl19