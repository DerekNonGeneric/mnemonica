'use strict';
Object.defineProperty(exports, "__esModule", { value: true });
exports.obey = void 0;
const errors_1 = require("../../descriptors/errors");
const { PROTOTYPE_USED_TWICE, } = errors_1.ErrorsTypes;
const used = new WeakSet();
const obey = (existentInstance, ModificatorType) => {
    let protoConstructor = ModificatorType;
    while (protoConstructor instanceof Function) {
        if (used.has(protoConstructor)) {
            const error = new PROTOTYPE_USED_TWICE(`${protoConstructor.name}.prototype > ${ModificatorType.name}`);
            throw error;
        }
        const sample = Reflect.getPrototypeOf(protoConstructor);
        if (sample instanceof Function) {
            protoConstructor = sample;
        }
        else {
            used.add(protoConstructor);
            break;
        }
    }
    Reflect.setPrototypeOf(protoConstructor, existentInstance.constructor);
};
exports.obey = obey;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib2JleUNvbnN0cnVjdG9yLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2FwaS90eXBlcy9vYmV5Q29uc3RydWN0b3IudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWSxDQUFDOzs7QUFFYixxREFBdUQ7QUFDdkQsTUFBTSxFQUNMLG9CQUFvQixHQUNwQixHQUFHLG9CQUFXLENBQUM7QUFFaEIsTUFBTSxJQUFJLEdBQUcsSUFBSSxPQUFPLEVBQUUsQ0FBQztBQUVwQixNQUFNLElBQUksR0FBRyxDQUFDLGdCQUFxQixFQUFFLGVBQW9CLEVBQUUsRUFBRTtJQUNuRSxJQUFJLGdCQUFnQixHQUFRLGVBQWUsQ0FBQztJQUM1QyxPQUFPLGdCQUFnQixZQUFZLFFBQVEsRUFBRSxDQUFDO1FBQzdDLElBQUksSUFBSSxDQUFDLEdBQUcsQ0FBQyxnQkFBZ0IsQ0FBQyxFQUFFLENBQUM7WUFDaEMsTUFBTSxLQUFLLEdBQUcsSUFBSSxvQkFBb0IsQ0FBQyxHQUFHLGdCQUFnQixDQUFDLElBQUksZ0JBQWdCLGVBQWUsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDO1lBQ3ZHLE1BQU0sS0FBSyxDQUFDO1FBQ2IsQ0FBQztRQUNELE1BQU0sTUFBTSxHQUFHLE9BQU8sQ0FBQyxjQUFjLENBQUMsZ0JBQWdCLENBQUMsQ0FBQztRQUN4RCxJQUFJLE1BQU0sWUFBWSxRQUFRLEVBQUUsQ0FBQztZQUNoQyxnQkFBZ0IsR0FBRyxNQUFNLENBQUM7UUFDM0IsQ0FBQzthQUFNLENBQUM7WUFDUCxJQUFJLENBQUMsR0FBRyxDQUFDLGdCQUFnQixDQUFDLENBQUM7WUFDM0IsTUFBTTtRQUNQLENBQUM7SUFDRixDQUFDO0lBSUQsT0FBTyxDQUFDLGNBQWMsQ0FBQyxnQkFBZ0IsRUFBRSxnQkFBZ0IsQ0FBQyxXQUFXLENBQUMsQ0FBQztBQUN4RSxDQUFDLENBQUM7QUFuQlcsUUFBQSxJQUFJLFFBbUJmIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5pbXBvcnQgeyBFcnJvcnNUeXBlcyB9IGZyb20gJy4uLy4uL2Rlc2NyaXB0b3JzL2Vycm9ycyc7XG5jb25zdCB7XG5cdFBST1RPVFlQRV9VU0VEX1RXSUNFLFxufSA9IEVycm9yc1R5cGVzO1xuXG5jb25zdCB1c2VkID0gbmV3IFdlYWtTZXQoKTtcblxuZXhwb3J0IGNvbnN0IG9iZXkgPSAoZXhpc3RlbnRJbnN0YW5jZTogYW55LCBNb2RpZmljYXRvclR5cGU6IGFueSkgPT4ge1xuXHRsZXQgcHJvdG9Db25zdHJ1Y3RvcjogYW55ID0gTW9kaWZpY2F0b3JUeXBlO1xuXHR3aGlsZSAocHJvdG9Db25zdHJ1Y3RvciBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7XG5cdFx0aWYgKHVzZWQuaGFzKHByb3RvQ29uc3RydWN0b3IpKSB7XG5cdFx0XHRjb25zdCBlcnJvciA9IG5ldyBQUk9UT1RZUEVfVVNFRF9UV0lDRShgJHtwcm90b0NvbnN0cnVjdG9yLm5hbWV9LnByb3RvdHlwZSA+ICR7TW9kaWZpY2F0b3JUeXBlLm5hbWV9YCk7XG5cdFx0XHR0aHJvdyBlcnJvcjtcblx0XHR9XG5cdFx0Y29uc3Qgc2FtcGxlID0gUmVmbGVjdC5nZXRQcm90b3R5cGVPZihwcm90b0NvbnN0cnVjdG9yKTtcblx0XHRpZiAoc2FtcGxlIGluc3RhbmNlb2YgRnVuY3Rpb24pIHtcblx0XHRcdHByb3RvQ29uc3RydWN0b3IgPSBzYW1wbGU7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHVzZWQuYWRkKHByb3RvQ29uc3RydWN0b3IpO1xuXHRcdFx0YnJlYWs7XG5cdFx0fVxuXHR9XG5cdC8vIGlmIChleGlzdGVudEluc3RhbmNlID09PSBudWxsIHx8IHR5cGVvZiBleGlzdGVudEluc3RhbmNlICE9PSAnb2JqZWN0Jykge1xuXHQvLyBcdHJldHVybjtcblx0Ly8gfVxuXHRSZWZsZWN0LnNldFByb3RvdHlwZU9mKHByb3RvQ29uc3RydWN0b3IsIGV4aXN0ZW50SW5zdGFuY2UuY29uc3RydWN0b3IpO1xufTtcbiJdfQ==